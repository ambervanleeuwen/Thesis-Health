

# Partition the data
ind <- sample(2, nrow(Cleandata2015), replace = TRUE, prob = c(0.8, 0.2))
train <- Cleandata2015[ind==1, ]
test <- Cleandata2015[ind==2, ]

## Perform the Ordinal Logistic Regression/ Proportional Odds Logistic Regression 
# This table outputs coeffient table including the value of the coefficients, stanrdard errors,
# t values, estimates for the intercepts, residual deviance ans AIC. AIC is the information criteria.
# Less is better

modelSubGenHealth <- polr(SubGenHealth ~ IrregularHours, train, Hess = TRUE)
summary(modelSubGenHealth)

## store table, ## calculate and store p values
## Combined table
## Caculating p-Value ## Between brackets so that everything will be in one table 
(ctablesubgenhealth <- coef(summary(modelSubGenHealth)))
pvaluesSubGenHealth <- pnorm(abs(ctablesubgenhealth[, "t value"]), lower.tail = FALSE) * 2
(ctablesubgenhealth <- cbind(ctablesubgenhealth, "p value" = round(pvaluesSubGenHealth,3)))

# Confidence intervals
ci <- confint(modelSubGenHealth)
ci
# 

## convert the coefficients into odds ratios
exp(coef(modelSubGenHealth))

## outcome: one increase from never to sometimes 
# one unit increase from never to sometimes, the odds of .. are 0.98 times greater
